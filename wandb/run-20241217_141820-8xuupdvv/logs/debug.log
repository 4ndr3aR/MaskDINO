2024-12-17 14:18:20,895 INFO    MainThread:8256 [wandb_setup.py:_flush():68] Current SDK version is 0.19.0
2024-12-17 14:18:20,895 INFO    MainThread:8256 [wandb_setup.py:_flush():68] Configure stats pid to 8256
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_setup.py:_flush():68] Loading settings from /home/giorgio/.config/wandb/settings
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_setup.py:_flush():68] Loading settings from /home/giorgio/venvs/MaskDINO/MaskDINO/wandb/settings
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_setup.py:_flush():68] Loading settings from environment variables
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_init.py:_log_setup():528] Logging user logs to /home/giorgio/venvs/MaskDINO/MaskDINO/wandb/run-20241217_141820-8xuupdvv/logs/debug.log
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_init.py:_log_setup():529] Logging internal logs to /home/giorgio/venvs/MaskDINO/MaskDINO/wandb/run-20241217_141820-8xuupdvv/logs/debug-internal.log
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_init.py:_jupyter_setup():474] configuring jupyter hooks <wandb.sdk.wandb_init._WandbInit object at 0x7652abd65970>
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_init.py:init():639] calling init triggers
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_init.py:init():645] wandb.init called with sweep_config: {}
config: {'VERSION': 2, 'MODEL': CfgNode({'LOAD_PROPOSALS': False, 'MASK_ON': False, 'KEYPOINT_ON': False, 'DEVICE': 'cuda', 'META_ARCHITECTURE': 'MaskDINO', 'WEIGHTS': '/mnt/shared/MaskDINO_stuff/MaskDINO_models/downloads/maskdino_r50_50ep_100q_celoss_hid1024_3s_semantic_ade20k_48.7miou.pth', 'PIXEL_MEAN': [123.675, 116.28, 103.53], 'PIXEL_STD': [58.395, 57.12, 57.375], 'BACKBONE': CfgNode({'NAME': 'build_resnet_backbone', 'FREEZE_AT': 0}), 'FPN': CfgNode({'IN_FEATURES': [], 'OUT_CHANNELS': 256, 'NORM': '', 'FUSE_TYPE': 'sum'}), 'PROPOSAL_GENERATOR': CfgNode({'NAME': 'RPN', 'MIN_SIZE': 0}), 'ANCHOR_GENERATOR': CfgNode({'NAME': 'DefaultAnchorGenerator', 'SIZES': [[32, 64, 128, 256, 512]], 'ASPECT_RATIOS': [[0.5, 1.0, 2.0]], 'ANGLES': [[-90, 0, 90]], 'OFFSET': 0.0}), 'RPN': CfgNode({'HEAD_NAME': 'StandardRPNHead', 'IN_FEATURES': ['res4'], 'BOUNDARY_THRESH': -1, 'IOU_THRESHOLDS': [0.3, 0.7], 'IOU_LABELS': [0, -1, 1], 'BATCH_SIZE_PER_IMAGE': 256, 'POSITIVE_FRACTION': 0.5, 'BBOX_REG_LOSS_TYPE': 'smooth_l1', 'BBOX_REG_LOSS_WEIGHT': 1.0, 'BBOX_REG_WEIGHTS': (1.0, 1.0, 1.0, 1.0), 'SMOOTH_L1_BETA': 0.0, 'LOSS_WEIGHT': 1.0, 'PRE_NMS_TOPK_TRAIN': 12000, 'PRE_NMS_TOPK_TEST': 6000, 'POST_NMS_TOPK_TRAIN': 2000, 'POST_NMS_TOPK_TEST': 1000, 'NMS_THRESH': 0.7, 'CONV_DIMS': [-1]}), 'ROI_HEADS': CfgNode({'NAME': 'Res5ROIHeads', 'NUM_CLASSES': 80, 'IN_FEATURES': ['res4'], 'IOU_THRESHOLDS': [0.5], 'IOU_LABELS': [0, 1], 'BATCH_SIZE_PER_IMAGE': 512, 'POSITIVE_FRACTION': 0.25, 'SCORE_THRESH_TEST': 0.05, 'NMS_THRESH_TEST': 0.5, 'PROPOSAL_APPEND_GT': True}), 'ROI_BOX_HEAD': CfgNode({'NAME': '', 'BBOX_REG_LOSS_TYPE': 'smooth_l1', 'BBOX_REG_LOSS_WEIGHT': 1.0, 'BBOX_REG_WEIGHTS': (10.0, 10.0, 5.0, 5.0), 'SMOOTH_L1_BETA': 0.0, 'POOLER_RESOLUTION': 14, 'POOLER_SAMPLING_RATIO': 0, 'POOLER_TYPE': 'ROIAlignV2', 'NUM_FC': 0, 'FC_DIM': 1024, 'NUM_CONV': 0, 'CONV_DIM': 256, 'NORM': '', 'CLS_AGNOSTIC_BBOX_REG': False, 'TRAIN_ON_PRED_BOXES': False, 'USE_FED_LOSS': False, 'USE_SIGMOID_CE': False, 'FED_LOSS_FREQ_WEIGHT_POWER': 0.5, 'FED_LOSS_NUM_CLASSES': 50}), 'ROI_BOX_CASCADE_HEAD': CfgNode({'BBOX_REG_WEIGHTS': ((10.0, 10.0, 5.0, 5.0), (20.0, 20.0, 10.0, 10.0), (30.0, 30.0, 15.0, 15.0)), 'IOUS': (0.5, 0.6, 0.7)}), 'ROI_MASK_HEAD': CfgNode({'NAME': 'MaskRCNNConvUpsampleHead', 'POOLER_RESOLUTION': 14, 'POOLER_SAMPLING_RATIO': 0, 'NUM_CONV': 0, 'CONV_DIM': 256, 'NORM': '', 'CLS_AGNOSTIC_MASK': False, 'POOLER_TYPE': 'ROIAlignV2'}), 'ROI_KEYPOINT_HEAD': CfgNode({'NAME': 'KRCNNConvDeconvUpsampleHead', 'POOLER_RESOLUTION': 14, 'POOLER_SAMPLING_RATIO': 0, 'CONV_DIMS': (512, 512, 512, 512, 512, 512, 512, 512), 'NUM_KEYPOINTS': 17, 'MIN_KEYPOINTS_PER_IMAGE': 1, 'NORMALIZE_LOSS_BY_VISIBLE_KEYPOINTS': True, 'LOSS_WEIGHT': 1.0, 'POOLER_TYPE': 'ROIAlignV2'}), 'SEM_SEG_HEAD': CfgNode({'NAME': 'MaskDINOHead', 'IN_FEATURES': ['res2', 'res3', 'res4', 'res5'], 'IGNORE_VALUE': 255, 'NUM_CLASSES': 32, 'CONVS_DIM': 256, 'COMMON_STRIDE': 4, 'NORM': 'GN', 'LOSS_WEIGHT': 1.0, 'DEFORMABLE_TRANSFORMER_ENCODER_IN_FEATURES': ['res3', 'res4', 'res5'], 'DEFORMABLE_TRANSFORMER_ENCODER_N_POINTS': 4, 'DEFORMABLE_TRANSFORMER_ENCODER_N_HEADS': 8, 'DIM_FEEDFORWARD': 1024, 'NUM_FEATURE_LEVELS': 3, 'TOTAL_NUM_FEATURE_LEVELS': 3, 'FEATURE_ORDER': 'high2low', 'MASK_DIM': 256, 'TRANSFORMER_ENC_LAYERS': 6, 'PIXEL_DECODER_NAME': 'MaskDINOEncoder'}), 'PANOPTIC_FPN': CfgNode({'INSTANCE_LOSS_WEIGHT': 1.0, 'COMBINE': CfgNode({'ENABLED': True, 'OVERLAP_THRESH': 0.5, 'STUFF_AREA_LIMIT': 4096, 'INSTANCES_CONFIDENCE_THRESH': 0.5})}), 'RETINANET': CfgNode({'NUM_CLASSES': 80, 'IN_FEATURES': ['p3', 'p4', 'p5', 'p6', 'p7'], 'NUM_CONVS': 4, 'IOU_THRESHOLDS': [0.4, 0.5], 'IOU_LABELS': [0, -1, 1], 'PRIOR_PROB': 0.01, 'SCORE_THRESH_TEST': 0.05, 'TOPK_CANDIDATES_TEST': 1000, 'NMS_THRESH_TEST': 0.5, 'BBOX_REG_WEIGHTS': (1.0, 1.0, 1.0, 1.0), 'FOCAL_LOSS_GAMMA': 2.0, 'FOCAL_LOSS_ALPHA': 0.25, 'SMOOTH_L1_LOSS_BETA': 0.1, 'BBOX_REG_LOSS_TYPE': 'smooth_l1', 'NORM': ''}), 'RESNETS': CfgNode({'DEPTH': 50, 'OUT_FEATURES': ['res2', 'res3', 'res4', 'res5'], 'NUM_GROUPS': 1, 'NORM': 'FrozenBN', 'WIDTH_PER_GROUP': 64, 'STRIDE_IN_1X1': False, 'RES5_DILATION': 1, 'RES2_OUT_CHANNELS': 256, 'STEM_OUT_CHANNELS': 64, 'DEFORM_ON_PER_STAGE': [False, False, False, False], 'DEFORM_MODULATED': False, 'DEFORM_NUM_GROUPS': 1}), 'MaskDINO': CfgNode({'LEARN_TGT': False, 'PANO_BOX_LOSS': False, 'SEMANTIC_CE_LOSS': True, 'DEEP_SUPERVISION': True, 'NO_OBJECT_WEIGHT': 0.1, 'CLASS_WEIGHT': 4.0, 'DICE_WEIGHT': 5.0, 'MASK_WEIGHT': 5.0, 'BOX_WEIGHT': 5.0, 'GIOU_WEIGHT': 2.0, 'COST_CLASS_WEIGHT': 4.0, 'COST_DICE_WEIGHT': 5.0, 'COST_MASK_WEIGHT': 5.0, 'COST_BOX_WEIGHT': 5.0, 'COST_GIOU_WEIGHT': 2.0, 'NHEADS': 8, 'DROPOUT': 0.0, 'DIM_FEEDFORWARD': 2048, 'ENC_LAYERS': 0, 'DEC_LAYERS': 9, 'INITIAL_PRED': True, 'PRE_NORM': False, 'BOX_LOSS': False, 'HIDDEN_DIM': 256, 'NUM_OBJECT_QUERIES': 100, 'ENFORCE_INPUT_PROJ': False, 'TWO_STAGE': False, 'INITIALIZE_BOX_TYPE': 'no', 'DN': 'seg', 'DN_NOISE_SCALE': 0.4, 'DN_NUM': 100, 'PRED_CONV': False, 'EVAL_FLAG': 1, 'TEST': CfgNode({'TEST_FOUCUS_ON_BOX': False, 'SEMANTIC_ON': True, 'INSTANCE_ON': False, 'PANOPTIC_ON': False, 'OBJECT_MASK_THRESHOLD': 0.8, 'OVERLAP_THRESHOLD': 0.8, 'SEM_SEG_POSTPROCESSING_BEFORE_INFERENCE': False, 'PANO_TRANSFORM_EVAL': True, 'PANO_TEMPERATURE': 0.06}), 'SIZE_DIVISIBILITY': 32, 'TRANSFORMER_DECODER_NAME': 'MaskDINODecoder', 'TRAIN_NUM_POINTS': 12544, 'OVERSAMPLE_RATIO': 3.0, 'IMPORTANCE_SAMPLE_RATIO': 0.75}), 'SWIN': CfgNode({'PRETRAIN_IMG_SIZE': 224, 'PATCH_SIZE': 4, 'EMBED_DIM': 96, 'DEPTHS': [2, 2, 6, 2], 'NUM_HEADS': [3, 6, 12, 24], 'WINDOW_SIZE': 7, 'MLP_RATIO': 4.0, 'QKV_BIAS': True, 'QK_SCALE': None, 'DROP_RATE': 0.0, 'ATTN_DROP_RATE': 0.0, 'DROP_PATH_RATE': 0.3, 'APE': False, 'PATCH_NORM': True, 'OUT_FEATURES': ['res2', 'res3', 'res4', 'res5'], 'USE_CHECKPOINT': False})}), 'INPUT': CfgNode({'MIN_SIZE_TRAIN': (256, 307, 358, 409, 460, 512, 563, 614, 665, 716, 768, 819, 870, 921, 972, 1024), 'MIN_SIZE_TRAIN_SAMPLING': 'choice', 'MAX_SIZE_TRAIN': 2048, 'MIN_SIZE_TEST': 512, 'MAX_SIZE_TEST': 2048, 'RANDOM_FLIP': 'horizontal', 'CROP': CfgNode({'ENABLED': True, 'TYPE': 'absolute', 'SIZE': [512, 512], 'SINGLE_CATEGORY_MAX_AREA': 1.0}), 'FORMAT': 'RGB', 'MASK_FORMAT': 'polygon', 'DATASET_MAPPER_NAME': 'mask_former_semantic', 'COLOR_AUG_SSD': True, 'SIZE_DIVISIBILITY': 512, 'IMAGE_SIZE': 1024, 'MIN_SCALE': 0.1, 'MAX_SCALE': 2.0}), 'DATASETS': CfgNode({'TRAIN': ('camvid_train_segmentation',), 'PROPOSAL_FILES_TRAIN': (), 'PRECOMPUTED_PROPOSAL_TOPK_TRAIN': 2000, 'TEST': ('camvid_test_segmentation',), 'PROPOSAL_FILES_TEST': (), 'PRECOMPUTED_PROPOSAL_TOPK_TEST': 1000}), 'DATALOADER': CfgNode({'NUM_WORKERS': 4, 'ASPECT_RATIO_GROUPING': True, 'SAMPLER_TRAIN': 'TrainingSampler', 'REPEAT_THRESHOLD': 0.0, 'REPEAT_SQRT': True, 'FILTER_EMPTY_ANNOTATIONS': True}), 'SOLVER': CfgNode({'LR_SCHEDULER_NAME': 'WarmupMultiStepLR', 'MAX_ITER': 3200, 'BASE_LR': 0.0001, 'BASE_LR_END': 0.0, 'MOMENTUM': 0.9, 'NESTEROV': False, 'WEIGHT_DECAY': 0.05, 'WEIGHT_DECAY_NORM': 0.0, 'GAMMA': 0.1, 'STEPS': (135000, 150000), 'NUM_DECAYS': 3, 'WARMUP_FACTOR': 1.0, 'WARMUP_ITERS': 10, 'WARMUP_METHOD': 'linear', 'RESCALE_INTERVAL': False, 'CHECKPOINT_PERIOD': 3200, 'IMS_PER_BATCH': 8, 'REFERENCE_WORLD_SIZE': 0, 'BIAS_LR_FACTOR': 1.0, 'WEIGHT_DECAY_BIAS': None, 'CLIP_GRADIENTS': CfgNode({'ENABLED': False, 'CLIP_TYPE': 'full_model', 'CLIP_VALUE': 0.01, 'NORM_TYPE': 2.0}), 'AMP': CfgNode({'ENABLED': False}), 'WEIGHT_DECAY_EMBED': 0.0, 'OPTIMIZER': 'ADAMW', 'BACKBONE_MULTIPLIER': 0.1}), 'TEST': CfgNode({'EXPECTED_RESULTS': [], 'EVAL_PERIOD': 5000, 'KEYPOINT_OKS_SIGMAS': [], 'DETECTIONS_PER_IMAGE': 100, 'AUG': CfgNode({'ENABLED': False, 'MIN_SIZES': (256, 384, 512, 640, 768, 896), 'MAX_SIZE': 3584, 'FLIP': True}), 'PRECISE_BN': CfgNode({'ENABLED': False, 'NUM_ITER': 200})}), 'OUTPUT_DIR': './output', 'SEED': -1, 'CUDNN_BENCHMARK': False, 'FLOAT32_PRECISION': '', 'VIS_PERIOD': 0, 'GLOBAL': CfgNode({'HACK': 1.0}), 'Default_loading': True, 'SAVED_MODEL_NAME': 'final_model'}
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_init.py:init():688] starting backend
2024-12-17 14:18:20,896 INFO    MainThread:8256 [wandb_init.py:init():692] sending inform_init request
2024-12-17 14:18:20,941 INFO    MainThread:8256 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-12-17 14:18:20,942 INFO    MainThread:8256 [wandb_init.py:init():705] backend started and connected
2024-12-17 14:18:20,947 INFO    MainThread:8256 [wandb_run.py:_label_probe_notebook():1327] probe notebook
2024-12-17 14:18:20,947 INFO    MainThread:8256 [wandb_run.py:_label_probe_notebook():1337] Unable to probe notebook: Expecting value: line 1 column 1 (char 0)
2024-12-17 14:18:20,947 INFO    MainThread:8256 [wandb_init.py:init():798] updated telemetry
2024-12-17 14:18:20,950 INFO    MainThread:8256 [wandb_init.py:init():830] communicating run to backend with 90.0 second timeout
2024-12-17 14:18:21,491 WARNING MainThread:8256 [wandb_init.py:init():1309] interrupted
Traceback (most recent call last):
  File "/home/giorgio/venvs/MaskDINO/lib/python3.12/site-packages/wandb/sdk/wandb_init.py", line 1305, in init
    return wi.init()
           ^^^^^^^^^
  File "/home/giorgio/venvs/MaskDINO/lib/python3.12/site-packages/wandb/sdk/wandb_init.py", line 833, in init
    result = run_init_handle.wait(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/giorgio/venvs/MaskDINO/lib/python3.12/site-packages/wandb/sdk/lib/mailbox.py", line 279, in wait
    found, abandoned = self._slot._get_and_clear(timeout=wait_timeout)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/giorgio/venvs/MaskDINO/lib/python3.12/site-packages/wandb/sdk/lib/mailbox.py", line 126, in _get_and_clear
    if self._wait(timeout=timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/giorgio/venvs/MaskDINO/lib/python3.12/site-packages/wandb/sdk/lib/mailbox.py", line 122, in _wait
    return self._event.wait(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/threading.py", line 655, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/threading.py", line 359, in wait
    gotit = waiter.acquire(True, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
